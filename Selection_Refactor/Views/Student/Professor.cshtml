@{
    ViewBag.Title = "志愿提交";
    ViewBag.CurrentTab = "professor";
    ViewBag.BoxTitle = "导师列表";
    ViewBag.Role = "Student";
}

<div class="row">
    <div class="col-sm-5">
        <label>第一志愿</label>
        <input id="first" readonly required class="send-text" style="margin-top: 10px; margin-left:20px; height: 34px;border-radius:3px ;  border: 1px solid rgb(204,204,204) ;">
    </div>
    <div class="col-sm-5">
        <label>第二志愿</label>
        <input id="second" readonly required class="send-text" style="margin-top: 10px; margin-left:20px; height: 34px;border-radius:3px ;  border: 1px solid rgb(204,204,204) ;">
    </div>
    <div class="col-sm-2">
        <button id="confirm" class="btn btn-default" style="right:auto;margin-top: 10px;">
            确认提交
        </button>
    </div>
</div>

@section css{
    <link rel="stylesheet" type="text/css" href="~/Content/plugins/datatables.net-bs/css/dataTables.bootstrap.css" />
}


<div class="col-md-12 col-sm-12 col-xs-12">
    <table class="table table-bordered table-striped" id="professorTable">
        <thead>
            <tr>
                <th>序号</th>
                <th>姓名</th>
                <th>职称</th>
                <th>详情</th>
                <th>第一志愿</th>
                <th>第二志愿</th>
            </tr>
        </thead>
    </table>
</div>
<div style="clear:both"></div>

@section script{
    <script src="~/Content/plugins/datatables.net/js/jquery.dataTables.js"></script>
    <script src="~/Content/plugins/datatables.net-bs/js/dataTables.bootstrap.js"></script>
    <script>

        var table = $('#professorTable').DataTable({
            ajax: {
                url: ' https://www.easy-mock.com/mock/5c95a7bd39712840142751d9/professorlist/getPro',
                dataSrc: 'data'
            },
            "columns": [
                {
                    data: function (row, type, set, meta) { //???????????????
                        return meta.row + 1;
                    }
                },
                { data: "ProName" },
                { data: "ProTitle" },
                {
                    data: function () {
                        return "<button id='checkInfo' class='btn btn-default'>查看</button>"
                    }
                },
                {
                    data: function () {
                        return "<button id='firstPro' class='btn btn-default' onclick='chooseFirstPro(this)'>选择</button>"
                    }
                },
                {
                    data: function () {
                        return "<button id='secondPro' class='btn btn-default' onclick='chooseSecondPro(this)'>选择</button>"
                    }
                }
            ]
        });

        function chooseFirstPro(btn) {
            var tr = $(btn).closest('tr');
            var row = table.row(tr).data();
            $("#first").val(row.ProName);
        }

        function chooseSecondPro(btn) {
            var tr = $(btn).closest('tr');
            var row = table.row(tr).data();
            $("#second").val(row.ProName);
        }

        $(document).ready(function () {
            $("#confirm").click(function () {
                var data = {
                    firstWill: $("#first").val(),
                    secondWill: $("#second").val(),
                }
                if (data.first == "" || data.second == "") {
                    alert("必须提交两个志愿");
                } else {
                    alert("提交成功");
                    $.post("/Student/comfirmWill", data, function (rdata) {
                        if (rdata.indexOf("success") != 0)
                            $.gyAlert({
                                title: "提交失败",
                                contentText: rdata
                            });
                    });
                }
            });

            $("body").on('click', "#checkInfo", function () {
                location.href = "http://baidu.com";
            });
        })

    </script>

}


